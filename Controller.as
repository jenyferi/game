package {	import flash.display.MovieClip;	import flash.events.MouseEvent;	import flash.events.Event;	public class Controller extends MovieClip {		private var _model:Model;		private var _boardSize:int;		private var _selection:Ball;				public function Controller(model:Model) {			_model = model;		}		public function addMouseEvents():void {			var c:int = 0;			var ball:Ball;			var r:int = 0;						_boardSize = _model.getBoardSize();						while (r < _boardSize) {				c = 0;				while (c < _boardSize) {					ball = _model.getBoardArray()[r][c];					ball.buttonMode = true;					ball.mouseChildren = false;					ball.addEventListener(MouseEvent.CLICK, onBallClick, false, 0, true);					++c;				}				++r;			}		}		private function onBallClick(e:MouseEvent):void {			var ball:Ball = e.target as Ball;			if (_selection != null) {				if (_selection == null || ball == null) {					throw new Error("Asked to swap a null selection or value");				}				if (_selection.isNeighbor(ball)) {					_model.swapBalls(_selection, ball);					_selection.unselect();					_selection = null;				}				if (_selection == ball) {					_selection.unselect();					_selection = null;				}			} else {				_selection = ball;				_selection.select();			}		}	}}